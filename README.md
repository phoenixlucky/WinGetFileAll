# WinGet文件同步工具

一个用于自动监控和同步WinGet下载文件的工具，可以将指定目录下的安装文件自动复制到目标文件夹。

## 主要功能

- 实时监控指定目录的文件变化
- 自动复制新增的安装文件（支持.exe和.whl格式）
- 显示文件复制进度条
- 自动清理空文件夹
- 支持文件复制失败重试机制
- 实时显示运行状态

## 安装说明

1. 确保已安装Python 3.x版本
2. 克隆或下载本项目到本地
3. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

## 配置说明

程序通过`config.json`文件进行配置，首次运行时会自动创建默认配置文件。配置项说明：

```json
{
    "temp_dir": "%TEMP%/WinGet",        // 监控目录，默认为系统临时目录下的WinGet文件夹
    "target_dir": "./soft",           // 目标目录，用于存放复制的文件
    "file_extensions": [".exe", ".whl"], // 需要同步的文件类型
    "scan_interval": 5,                // 扫描间隔（秒）
    "retry_attempts": 3,               // 复制失败重试次数
    "retry_delay": 1                   // 重试等待时间（秒）
}
```

## 使用方法

1. 运行程序：
   ```bash
   python WinGetFileAll.py
   ```

2. 程序启动后会显示当前状态，包括：
   - 监控目录路径
   - 目标目录路径
   - 已复制文件数量
   - 当前处理的文件（如有）
   - 最后更新时间

3. 使用WinGet安装软件时，程序会自动将下载的安装文件复制到指定目录

4. 按`Ctrl+C`可以安全退出程序

## 日志记录

程序运行日志保存在目标目录下的`winget_file_all.log`文件中，记录了文件复制、错误信息等详细信息。

## 常见问题

1. **Q: 为什么有些文件没有被复制？**
   A: 检查文件扩展名是否在配置文件的`file_extensions`列表中，以及是否有足够的磁盘空间和文件权限。

2. **Q: 如何修改监控的文件类型？**
   A: 在`config.json`文件中修改`file_extensions`数组，添加或删除需要监控的文件扩展名。

3. **Q: 程序占用资源高吗？**
   A: 程序采用文件系统事件监控机制，资源占用较低。可以通过调整`scan_interval`参数来平衡性能和响应速度。

## 注意事项

- 确保目标目录有足够的磁盘空间
- 程序需要对监控目录和目标目录有读写权限
- 建议定期检查日志文件，及时发现并处理可能的问题